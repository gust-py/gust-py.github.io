<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Assistente IA — Chat</title>
<style>
  html, body {
    margin:0; padding:0; height:100%; background:#000; color:#fff; font-family:Arial, sans-serif;
    overflow:hidden;
  }
  canvas#stars { position:fixed; top:0; left:0; width:100%; height:100%; z-index:0; }
  .app { position:relative; z-index:1; display:flex; flex-direction:column; height:100%; max-width:800px; margin:auto; }
  .messages { flex:1; overflow-y:auto; padding:10px; display:flex; flex-direction:column-reverse; gap:8px; }
  .msg { padding:10px 14px; border-radius:10px; max-width:80%; line-height:1.4; }
  .user { align-self:flex-end; background:linear-gradient(90deg,#2b6bff,#66ccff); color:#001; }
  .bot { align-self:flex-start; background:#111; border:1px solid rgba(255,255,255,0.05); }
  .composer { display:flex; padding:10px; gap:8px; border-top:1px solid rgba(255,255,255,0.1); }
  textarea { flex:1; padding:10px; border-radius:8px; border:0; background:#111; color:#fff; resize:none; }
  button { padding:10px 12px; border-radius:8px; border:0; background:#66ccff; color:#001; font-weight:700; cursor:pointer; }
  footer { text-align:center; padding:6px; font-size:12px; color:#888; }
</style>
</head>
<body>

<canvas id="stars"></canvas>
<div class="app">
  <div class="messages" id="messageContainer"></div>
  <div class="composer">
    <textarea id="input" placeholder="Digite algo..."></textarea>
    <button id="sendBtn">Enviar</button>
  </div>
</div>
<footer>Assistente IA • Powered by Hugging Face</footer>

<script>
/* --- Fundo estrelado --- */
const canvas = document.getElementById('stars');
const ctx = canvas.getContext('2d');
let stars = [];
function resize() { canvas.width=window.innerWidth; canvas.height=window.innerHeight; }
window.addEventListener('resize', resize);
resize();
for(let i=0;i<200;i++){ stars.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,r:Math.random()*1.2+0.2,speed:Math.random()*0.2+0.05}); }
function drawStars(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    for(let s of stars){
        s.x -= s.speed;
        if(s.x<0){ s.x=canvas.width; s.y=Math.random()*canvas.height; }
        ctx.fillStyle='white'; ctx.beginPath(); ctx.arc(s.x,s.y,s.r,0,Math.PI*2); ctx.fill();
    }
    requestAnimationFrame(drawStars);
}
drawStars();

/* --- Chat --- */
const input = document.getElementById('input');
const sendBtn = document.getElementById('sendBtn');
const container = document.getElementById('messageContainer');

const HF_API_KEY = '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'; // sua chave Hugging Face
const HF_MODEL = 'mistralai/Mistral-7B-Instruct-v0.2'; // modelo desejado

function appendMessage(text,who='bot'){
    const el = document.createElement('div');
    el.className='msg '+(who==='user'?'user':'bot');
    el.textContent=text;
    container.prepend(el);
}

async function queryHF(prompt){
    const url = `https://api-inference.huggingface.co/models/${HF_MODEL}`;
    const headers = { 'Authorization':'Bearer '+HF_API_KEY, 'Content-Type':'application/json' };
    const body = JSON.stringify({inputs:prompt, parameters:{max_new_tokens:256, temperature:0.7}});
    const res = await fetch(url,{method:'POST', headers, body});
    if(!res.ok) throw new Error('Erro na API HF');
    const data = await res.json();
    if(Array.isArray(data) && data[0]?.generated_text) return data[0].generated_text;
    if(data.generated_text) return data.generated_text;
    return JSON.stringify(data);
}

async function sendMessage(){
    const text = input.value.trim();
    if(!text) return;
    appendMessage(text,'user');
    input.value='';
    const loader = appendMessage('…','bot');
    try{
        const reply = await queryHF(text);
        loader.textContent = reply;
    }catch(err){
        loader.textContent='Erro: '+err.message;
    }
    container.scrollTop=0;
}

sendBtn.addEventListener('click',sendMessage);
input.addEventListener('keydown',(e)=>{ if(e.key==='Enter'&&!e.shiftKey){ e.preventDefault(); sendMessage(); } });
</script>

</body>
</html>
